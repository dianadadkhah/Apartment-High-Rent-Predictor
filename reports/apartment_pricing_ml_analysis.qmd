---
title: Predicting High-Priced Rental Apartments in the USA
jupyter:
  kernelspec:
    display_name: Python (Group_26)
    language: python
    name: group_26
format:
  html:
    toc: true
    toc-depth: 3
    code-fold: true
  pdf:
    toc: true
    toc-depth: 3
link-citations: true  
execute:
  echo: false   # hide code by default
  warning: false
  error: false
---

### Milestone 1 – Group_26

---


```{python}
import pandas as pd

```

## **Summary**

This project investigates whether it is possible to predict when an apartment listing in the United States is **high-priced relative to other listings in the same state**. Using the *Apartment for Rent Classified* dataset from the UCI Machine Learning Repository, we defined a binary target indicating whether each listing's price was above the state-level median. We developed a logistic regression model to classify listings as either high-priced or not. The final classifier achieved an accuracy of 0.7 on unseen data, indicating that it correctly predicts a listing as high-priced in most cases. 

The notebook includes:

- Data loading from the web  
- Data cleaning and wrangling  
- Exploratory data analysis  
- Visualizations  
- Classification modeling  
- Results, discussion, and conclusions  

## Introduction

Homeownership in the United States has become somewhat less attainable for many Americans due to increasing housing prices, rising mortage rates and other increases in the cost of living. As a result, according to recent surveys, around 84% of Gen Z adults report delaying major life milestones in order to afford a home, with many turning to long-term renting instead. Nearly 75% of Gen Z say they prefer renting to owning, which is important to note as this generation represents more than 20% of the U.S. population. Growing rental demand is driving new construction as developers across the country are expected to add more than 500,000 new apartment units across the country.  

These trends lead us to wonder if apartment rental prices vary dramatically across the U.S. A price considered as “expensive” in Texas may be considered “cheap” in New York. As many Gen Z adults are relocating to higher-cost states and more than 75% of them rent, understanding these price differences is increasingly important. Additionally, rental prices are influenced by a variety of listing features. For example, apartments with more bedrooms or bathrooms are generally associated with higher-prices. Other features such as whether pets are allowed or whether the apartment includes additional fees, may also signal higher quality or prices. These features will be incorporated into our model to assess their impact on whether an apartment is classified as high-priced or not. To create a meaningful comparison across regions, we evaluated whether each apartment is **high-priced relative to the median rent within its own state**.

## Research Question

Can a machine learning algorithm accurately predict whether an apartment listing is high-priced relative to the median rental price in its state, using features such as square footage, number of bedrooms and bathrooms, and various listing attributes?

## Dataset

We use the **Apartment for Rent Classified** dataset from the UCI Machine Learning Repository. The dataset contains:

- 10,000+ apartment listings  
- Structural and listing details  
- Geographic information  
- Price and square footage  

---

# Data Cleaning & Wrangling

We prepared the dataset by:

1. Loading the data from the UCI ML Repository 
1. Selecting relevant columns  
2. Removing rows with missing or invalid values  
3. Computing the median rental price for each state  
4. Creating a binary target variable `high_price`

```{python}
#| label: tbl-raw-data
#| tbl-cap: Preview of the apartment rental listings dataset showing key attributes such as listing ID, title and description, amenities, number of bathrooms and bedrooms, price, square footage, location (city, state, latitude, longitude), data source, and posting time. The table illustrates the structure and diversity of features used for exploratory analysis and modeling.
raw_data_table = pd.read_csv("../data/raw/data.csv")
raw_data_table
```


```{python}

#| label: tbl-cleaned-dataset
#| tbl-cap: Cleaned and feature-engineered apartment listings used for modeling. The table includes selected numerical and categorical predictors (price, square footage, bathrooms, bedrooms, state, pet policy, fee status, and photo availability) after removing missing, non-positive, and duplicate records. A state-level median price is computed and used to derive the binary target variable high_price, indicating whether a listing is priced above the median for its state.
cleaned_dataset_table = pd.read_csv("../data/processed/full_cleaned_data.csv")
cleaned_dataset_table
```

```{python}
#| label: tbl-X-train-dataset
#| tbl-cap: Training feature matrix (X_train) obtained after performing the train–test split. This dataset contains only the predictor variables used to train the model, with all preprocessing steps applied.
#| 
X_train_set = pd.read_csv("../data/processed/X_train.csv")
X_train_set 
```
```{python}
#| label: tbl-y-train-dataset
#| tbl-cap: Training target vector (y_train) obtained after the train–test split. This table contains the binary response variable indicating whether an apartment listing is classified as high-priced based on the state-level median price.
#| 
y_train_set = pd.read_csv("../data/processed/y_train.csv")
y_train_set 
```
```{python}
#| label: tbl-X-test-dataset
#| tbl-cap: Test feature matrix (X_test) obtained after performing the train–test split. This dataset contains the predictor variables used to evaluate the trained model, with all preprocessing steps applied.
#| 
X_test_set = pd.read_csv("../data/processed/X_test.csv")
X_test_set
```

```{python}
#| label: tbl-y-test-dataset
#| tbl-cap: Test target vector (y_test) obtained after the train–test split. This table contains the true binary labels used to evaluate the model’s predictive performance.
#| 
y_test_set = pd.read_csv("../data/processed/y_test.csv")
y_test_set
```



# Exploratory Data Analysis (EDA)

We explored:

- Summary statistics  
- Class balance  
- Price distribution  
- Relationship between size and price  

```{python}
#| label: tbl-describe
#| tbl-cap: Summary statistics for apartment listings, including price, square footage, and number of bathrooms. The table reports the count, central tendency (mean and median), dispersion (standard deviation and interquartile range), and extrema, providing an overview of the scale and variability of key features in the dataset.
describe_table = pd.read_csv("../results/tables/describe.csv")
describe_table
```


```{python}
#| vscode: {languageId: r}
#| label: tbl-target
#| tbl-cap: Class distribution of the binary target variable (high_price). Approximately 51.1% of listings are labeled as high-priced (1), while 48.9% are labeled as not high-priced (0), indicating a nearly balanced classification problem.
target_tbl = pd.read_csv("../results/tables/target_counts.csv")
target_tbl 
```

![The histogram shows a right-skewed distribution of apartment rental prices, with most listings concentrated between approximately $800 and $1,500 and a long upper tail.](../results/figures/hist_price.png){#fig-hist width=70%}


![Relationship between apartment size and rental price, with points colored by the high-price label (1 = high-priced, 0 = not high-priced). Larger units generally command higher prices, though substantial overlap between the two classes highlights variability in pricing beyond square footage alone.](../results/figures/scatter.png){#fig-scatter width=70%}

# Modeling: Logistic Regression Classifier

We predict `high_price` using:

**Numeric features**. 

- square_feet  
- bathrooms  

**Categorical features**. 

- bedrooms  
- state  
- pets_allowed  
- fee  
- has_photo  

We use a train-test split and a preprocessing pipeline.

```{python}

#| label: tbl-logistic
#| tbl-cap: Classification performance of the logistic regression model evaluated on the held-out test set using a train–test split and a preprocessing pipeline. Reported metrics include accuracy, precision, recall, and F1-score, summarizing the model’s overall predictive effectiveness and balance between false positives and false negatives.
LogisticRegression_table = pd.read_csv("../results/models/logistic_regression_metrics.csv")
LogisticRegression_table
```



![Confusion matrix summarizing the binary classification performance for predicting high-priced apartments. The model correctly identifies 2,610 low-priced and 2,359 high-priced units, while misclassifying 973 low-priced units as high-priced and 1,198 high-priced units as low-priced, highlighting a moderate trade-off between false positives and false negatives.](../results/figures/confusion_matrix.png){#fig-confusion width=70%}


# Discussion

## Summary of Findings

The logistic regression classifier performed reasonably well in predicting whether an apartment is high-priced relative to its state’s median rental price. Our logistic regression model achieved an accuracy of approximately 0.7, indicating that the model correctly classified 70% of apartment listings as either high-priced or not relative to their state's median rent. The model has a precision score of 0.715 which means the model was correct about 71% of the time when predicting an apartment to be high-priced. The recall score of approximately 0.660 shows the model was able to correctly identify about 66% of actually high-priced listings. Combined, these values resulted in a F1-score of 0.686. 

- Overall, these metrics suggest that the model provides a reasonably balanced performance, though there is room for improvement in correctly identifying all high-priced apartments.

## Analysis

The model performed well when identifying low-priced listings as indicated by the large number of true negatives (2,893). However, it was slightly less successful at identifying high-priced listings misclassifying 1,323 of them as not high-priced when they in fact were. These results align reasonably well with our expectations. We anticipated that apartment prices would vary across the country and the model's high precision of 0.72 suggests that it is usually correct when predicting a listing as high-priced, supporting the idea that certain features contribute meaningfully to the classification. The F1-score of ~0.69 indicates that the model is not overfitting to one class and maintains a balanced trade-off between identifying high-priced listings and avoiding false positives. 

Overall, the results suggest that rental price classification at the state level is predictable to a moderate degree, but not with perfect accuracy. This is likely due to the variability of housing markets across the country. The model performs as expected for a logistic regression approach and provides a useful baseline for predicting whether a listing is high-priced relative to its state’s median rent. 

## Limitations and Future Work
A key limitation of this analysis is that logistic regression may be too simple to capture the full complexity of rental markets, which vary widely across and within states. The model's moderate accuracy (0.70) and recall (0.66) indicate that many high priced listings remain misclassified, suggesting that important predictive features were not included.

Future work could expand this analysis by incorporating more advanced models such as random forests, as well as extracting additional insights through NLP features derived from apartment descriptions. It may also be valuable to explore state by state differences in greater depth and to perform regression modelling to predict exact prices rather than broader categories. Further improvements could come from adding location specific features like the neighbourhood characteristics, building age, or available amenities which may contribute more meaningfully to overall model performance.

# References

1. Investopedia. (2023). Gen Z is having more trouble affording a home — How some are achieving homeownership. https://www.investopedia.com/gen-z-is-having-more-trouble-affording-a-home-how-some-are-achieving-homeownership-11826137

2. Newsweek. (2023). Gen Z is renting, not buying: What it means for the country’s future. https://www.newsweek.com/gen-z-renting-not-buying-what-means-country-future-2120726

3. PR Newswire. (2023). Top 10 states to which Gen Zers are moving and the states they are leaving. https://www.prnewswire.com/news-releases/top-10-states-to-which-gen-zers-are-moving-and-the-states-they-are-leaving-302058380.html

4. Starmer, J. (n.d.). Classification metrics educational videos [YouTube channel]. StatQuest. https://www.youtube.com/user/joshstarmer

5. Scikit-Learn. (n.d.). Logistic regression & preprocessing. https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression

6. UCI Machine Learning Repository. (n.d.). Apartment for rent classified dataset. https://archive.ics.uci.edu/ml/datasets/Apartment+for+Rent+Classified

